## 01 分数规划（0-1 Fractional Programming）

---

### 一、问题描述

**$Query$:** 
形式化地 , 给定 $n$ 组二元组 $(a_i, b_i)$，要求从中选择 **若干**，使得分数比值
$$
\frac{\sum a_i}{\sum b_i}
$$

达到最大值。

- 核心问题：在组合中选择若干个元素，使得 **加权比值最大**。  

---

### 二、解法思路

我们可以使用 **二分答案 + 01 分数规划** 的方法求解：

1. **假设答案 $mid$**  
   - 对分数的最大值进行二分，假设当前尝试值为 $mid$。  

2. **构造理论差值**  
   - 对每个二元组 $(a_i, b_i)$，计算理论值：

$$
a'_i = mid \times b_i
$$

   - 定义每个元素的剩余值：

$$
c_i = a_i - a'_i = a_i - mid \times b_i
$$

   - 也就是 $c_i$ 表示在假设答案 $mid$ 下，每个选择对最终分数的 **贡献或亏损**。

3. **判断可行性**  
   - 对所有 $c_i$，选择贡献为正的元素，并求和 $\sum c_i$：
     - 若 

$$
\sum c_i \ge 0
$$

​    则说明 **可以达到 $mid$**，答案可行。 
​    否则，说明 **答案过大**，需要降低 $mid$。

4. **二分调整**  
   - 根据可行性，调整二分上下界，直到找到最大可行的 $mid$。  

---

### 三、核心思想

- 将 **分式最值问题** 转化为 **二分 + 其他问题**：  
  - 不直接处理分数，而是通过差值 $c_i$ 判断选择组合是否可行。  
- 对每个 $i$，$c_i = a_i - mid \cdot b_i$ 表示：
  - 正数：选该元素对分数有提升  
  - 负数：选该元素对分数有削弱  

- 通过选择 $c_i > 0$ 的元素，就可以验证当前 $mid$ 是否可行。

---

### 四、复杂度分析

- 计算 $c_i$：$O(n)$  
- 筛选正贡献元素并求和：$O(n)$  
- 二分答案精度为 $\epsilon$：$O(\log(\text{范围}/\epsilon))$  

**总体复杂度（仅考虑分数规划）：**
$$
O\Big( n \cdot \log\frac{\text{范围}}{\epsilon} \Big)
$$

---

### 五、总结

- 01 分数规划是一类典型的 **二分 + 剩余差值** 问题。  
- 核心在于：将分数约束转化为 **线性差值约束**，再进行可行性检查。  
- 适用于 **收益/成本比值最大化**、**效率最优化** 等问题。  
- 当允许选择任意若干元素时，只需选择正贡献的元素，逻辑更简单。
