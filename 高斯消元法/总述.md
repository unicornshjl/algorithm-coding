# 🌟 高斯消元法（Gaussian Elimination）

高斯消元法是一种用于 **解线性方程组** 的方法，其本质属于 **线性代数** 内容。  
根据题目类型不同，高斯消元法大致可以分为三类：

---

## 分类

1. **加法方程组**（普通线性方程组）  
2. **异或方程组**（在模 $2$ 意义下的线性方程组）  
3. **同余方程组**（模意义下的线性方程组）

我们先从最常见的 **加法方程组** 入手。

---
### 消元
假设我们操作的是 $n$ 行 $n$ $+$ $1$ 列的矩阵

因为即使 $n$ 行 $n$ $+$ $1$ 列的矩阵 , 我们仍然可以通过增加元或者增加方程的方法成为这样的矩阵

我们从 $1$ 开始遍历每一个主元列 对于当前主元列 $i$ , 我们要去找 **非主元列且值的绝对值最大的**的行 记作 $line$

那么如何判断非主元列呢? 假设当前判断的列是第 $j$ 列 其为主元列的条件为 $j$ $<$ $i$ 且 $a[j][j]$非 $0$

然后将第 $i$ 行和第 $line$ 行整体交换 , 判断第 $a[i][i]$ 是否为 $0$ , 如果为 $0$ 则表示当前列 **非主元列**

否则若当前列为主元列 , 那么先将第 $i$ 行第 $i$ 列的值变为 $1$ 也就是第 $i$ 行全体 $/$ $a[i][i]$

然后遍历每一行 使得其他所有行的第 $i$ 列全部消为 $0$
### 解的情况
消元结束之后遍历每一行 设当前为第 $i$ 行

若 $a[i][i]$ $=$ $0$ 则有两种情况

- $a[i][n + 1]$ $=$ $0$ 则表明该列所对应元为**自由元**
    
- $a[i][n + 1]$ $!=$ $0$  则表明方程存在矛盾 **无解**
    
否则 若唯一解 那么 $x_i$ 即为 $a[i][n + 1]$

若非唯一解 则主元的取值取决于自由元的取值 一旦自由元已经确定 那么主元必定唯一确定

| 情况     | 条件                              |
| -------- | -------------------------------  |
| 无解     | 存在一行主元为 $0$ 且常数项不为 $0$ |
| 唯一解   | 每一列都有主元，无自由元            |
| 无穷多解 | 存在自由元                         |

实现上 , 由于加法方程组经常涉及到浮点数的运算 所以判断是否为 $0$ 需要利用一个常数 `eps = 1e-7`
若值 $<=$ `eps` 则认为其为 $0$

---
对于异或方程组 实际上其为一种特殊的同余方程组 因为 异或可以看做是模 $2$ 意义下的加法

大体上 流程和加法方程组一致 只是由于异或的逆运算仍然是异或 所以异或也许会更简单

区别在于加法方程组中我们需要去寻找**绝对值最大**的元素 , 而在异或方程组中 我们只需要找到一个**值为 $1$ ** 的元素即可

另外 , 在消元的过程中 , 我们只需要找其他行中该列不为 $0$ 的即可 已经为 $0$ 的行没有必要再消元

---
对于同余方程组 大体上仍然和加法方程组一致

我们同样只需要对于每一列去找一个值非 $0$ 的行即可

同时由于同余 我们在消元时应该先计算最大公约数然后再消元以避免小数、负数

注意取余要 ((+ x) % mod + mod) % mod 最后算答案的时候要使用乘法逆元 找到这一列非 $0$ 的进行操作即可

求解时 不再是简单的 $a[i][n + 1]$ 而是应该用 $a[i][n + 1]$ $\times$ $inv(a[i][i])$ 再 $% mod$


### 对比三者
| 内容     | 加法方程组   | 异或方程组         | 同余方程组     |
| -------- | ------------ | ------------------ | -------------- |
| 运算类型 | 实数加法     | 模 2 加法（异或）  | 模 mod 加法    |
| 主元选择 | 绝对值最大   | 任意值为 1         | 任意非 0       |
| 逆元计算 | 除法         | 自身异或           | 乘法逆元       |
| 特点     | 常规线性代数 | 简单高效（位运算） | 模运算避免小数 |

### 时间复杂度分析
$O(N^3)$

另 , 由于异或方程组中出现的值只有 $0$ 和 $1$ 所以其可以和 `bitset` 结合 减小时间的开支
